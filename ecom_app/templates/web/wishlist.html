{% extends 'web/base.html' %}
{% load static %}
{% block content %}

    <!-- PAGE HEADER -->
    <section class="relative border-b border-line min-h-[40vh] sm:min-h-[60vh] flex items-center">

        <!-- Background image -->
        <div class="absolute inset-0 bg-cover bg-center pagebanner"></div>

        <!-- Overlay for readability -->
        <div class="absolute inset-0 bg-white/80"></div>

        <!-- Content -->
        <div class="relative px-6 w-full">
            <div class="max-w-8xl mx-auto py-12 sm:py-16">

                <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4">
                    <div>
                        <div class="text-sm sm:text-lg text-brownMain font-medium">
                            Checkout
                        </div>

                        <h1 class="mt-2 text-4xl sm:text-6xl font-[500] leading-[1.1] tracking-[-0.02em]">
                            Complete your order with confidence
                        </h1>

                        <p class="mt-3 text-zinc-700 max-w-2xl">
                            Review your items, confirm delivery details, and choose a secure payment method to complete
                            your Ayurvedic purchase.
                        </p>
                    </div>

                </div>

            </div>
        </div>
    </section>
    <section class="py-20 bg-white border-t border-line">
        <div class="max-w-8xl mx-auto px-4 sm:px-6">

            <!-- Product Grid -->
            <div class="mt-12 grid gap-6 sm:grid-cols-2 lg:grid-cols-4 reveal reveal-bottom">

                  {% for item in wishlist_items %}
                  {% with product=item.product %}

                <div class="group border border-line rounded-2xl overflow-hidden bg-white hover:shadow-soft transition">

                    <!-- Image -->
                    <div class="relative bg-soft">
                        <img src="{{ product.thumbnail.url }}"
                                    alt="{{ product.product_name }}"
                                    class="w-full aspect-square object-cover" />

                        <!-- Offer badge -->
                      {% if product.discount_percentage %}
                        <div class="absolute top-3 left-3">
                            <span
                                 class="inline-flex items-center rounded-full bg-brownMain text-white text-xs font-semibold px-3 py-1">
                                {{ product.discount_percentage}}% OFF
                            </span>
                        </div>
                        {% endif %}

                        <!-- Top-right icons -->
                        <div class="absolute top-3 right-3 flex flex-col gap-2">

                             <!-- Remove from Wishlist -->
                            <button
                                class="wishlist-btn h-9 w-9 rounded-full bg-white border border-line
                                    grid place-items-center hover:bg-red-50 hover:border-red-200 transition"
                                data-product="{{ product.id }}"
                                data-auth="true"
                                data-url="{% url 'web:toggle_wishlist' %}"
                                data-login="{% url 'web:login' %}"
                                aria-label="Remove item">

                                <svg xmlns="http://www.w3.org/2000/svg"
                                    class="h-4 w-4 text-red-600"
                                    viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M3 6h18" />
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M8 6V4h8v2" />
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M19 6l-1 14H6L5 6" />
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M10 11v6M14 11v6" />
                                </svg>
                            </button>

                            <!-- Add to Cart -->
                            <button class="h-9 w-9 rounded-full bg-white border border-line grid place-items-center
                       hover:bg-soft transition" aria-label="Add to cart">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-brownMain"
                                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path stroke-linecap="round" stroke-linejoin="round"
                                        d="M6 6h15l-1.5 8.5a2 2 0 0 1-2 1.7H9a2 2 0 0 1-2-1.6L5 3H2" />
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M9.5 21a1.5 1.5 0 1 0 0-3
                           1.5 1.5 0 0 0 0 3z
                           M17.5 21a1.5 1.5 0 1 0 0-3
                           1.5 1.5 0 0 0 0 3z" />
                                </svg>
                            </button>

                        </div>
                    </div>

                    <!-- Content -->
                    <div class="p-5">

                        <!-- Title -->
                        <h3 class="text-[18px] font-semibold text-zinc-900 leading-tight">
                              {{ product.product_name }}
                        </h3>

                        <!-- Rating -->
                        <div class="mt-2 flex items-center gap-2">
                            <div class="flex items-center gap-0.5">
                                <svg class="w-4 h-4 text-yellow-400 fill-current" viewBox="0 0 20 20">
                                    <use href="#star" />
                                </svg>
                                <svg class="w-4 h-4 text-yellow-400 fill-current" viewBox="0 0 20 20">
                                    <use href="#star" />
                                </svg>
                                <svg class="w-4 h-4 text-yellow-400 fill-current" viewBox="0 0 20 20">
                                    <use href="#star" />
                                </svg>
                                <svg class="w-4 h-4 text-yellow-400 fill-current" viewBox="0 0 20 20">
                                    <use href="#star" />
                                </svg>
                                <svg class="w-4 h-4 text-zinc-300 fill-current" viewBox="0 0 20 20">
                                    <use href="#star" />
                                </svg>
                            </div>
                            <span class="text-sm text-zinc-600 leading-none">
                                4.0 <span class="text-zinc-400">(128)</span>
                            </span>
                        </div>

                        <!-- Price -->
                        
                                <div class="mt-3 flex items-baseline gap-2">
                                    
                                    {% if product.discount_percentage > 0 %}
                                    <!-- Discounted price -->
                                    <span class="text-[18px] font-semibold text-brownMain">
                                        ₹{{ product.offer_price_rounded }}
                                    </span>

                                    <!-- Original price (striked) -->
                                    <span class="text-[15px] line-through text-zinc-400">
                                        ₹{{ product.original_price|floatformat:0 }}
                                    </span>

                                    <!-- Discount percentage -->
                                    <span class="text-[13px] font-semibold text-green-600">
                                        {{ product.discount_percentage|floatformat:0 }}% OFF
                                    </span>

                                    {% else %}
                                    <!-- Only original price when no discount -->
                                     <span class="text-[18px] font-semibold text-brownMain">
                                        ₹{{ product.original_price|floatformat:0 }}
                                    </span>
                                    {% endif %}
                                </div>

                        <!-- Action -->
                        <div class="mt-4">
                            <a href="{% url 'web:product_detail' product.slug %}"
                                class="block w-full rounded-xl border border-brownMain text-brownMain py-2 text-sm text-center hover:bg-soft transition">
                                Shop Now
                            </a>
                        </div>
                    </div>

                </div>
                 {% endwith %}
    {% empty %}
        <p class="col-span-4 text-center text-zinc-500">
            Your wishlist is empty.
        </p>
    {% endfor %}





                <!-- Repeat similarly for products 4,5,6 -->

            </div>
        </div>
    </section>
{% endblock %}